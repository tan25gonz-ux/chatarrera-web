<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Contabilidad - Chatarrera</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Navbar -->
  <div class="navbar">
    <span class="menu-toggle" onclick="toggleMenu()">â˜°</span>
    <h1>Contabilidad</h1>
  </div>

  <!-- Sidebar -->
  <div id="sidebar" class="sidebar">
    <button onclick="window.location.href='inventario.html'">ðŸ“Š Ver Inventario</button>
    <button onclick="window.location.href='ventas.html'">ðŸ›’ Registrar Contenedor</button>
    <button onclick="window.location.href='contabilidad.html'">ðŸ’µ Ver Contabilidad</button>
    <button onclick="window.location.href='precios.html'">ðŸ’² Editar Precios</button>
    <button onclick="window.location.href='factura.html'">ðŸ§¾ Configurar Factura</button>
    <button id="btnCerrar" type="button">ðŸšª Cerrar SesiÃ³n</button>
  </div>

  <div class="container">
    <!-- Filtros -->
    <div class="card filters">
      <h2>ðŸ“… Filtros</h2>
      <button onclick="mostrarTodos()">Todo</button>
      <button onclick="filtrar('ingreso')">Ingresos</button>
      <button onclick="filtrar('egreso')">Egresos</button>
    </div>

    <!-- Agregar movimiento manual -->
    <div class="card">
      <h2>âž• Agregar Movimiento Manual</h2>
      <input type="text" id="descripcion" placeholder="DescripciÃ³n" />
      <input type="number" id="monto" placeholder="Monto â‚¡" />
      <select id="tipoMovimiento">
        <option value="ingreso">Ingreso</option>
        <option value="egreso">Egreso</option>
      </select>
      <button onclick="agregarMovimiento()">Guardar Movimiento</button>
    </div>

    <!-- Filtro por fecha -->
    <div class="card">
      <h2>ðŸ“† Filtrar por fecha</h2>
      <input type="date" id="filtroFecha" />
      <button onclick="filtrarPorFecha()">Filtrar</button>
      <button onclick="mostrarTodos()">Ver Todo</button>
    </div>

    <!-- Balance -->
    <div class="card balance">
      <h2>ðŸ’° Balance</h2>
      <p id="balanceGeneral" class="neutro">Balance: â‚¡0</p>
    </div>

    <!-- Listados -->
    <div class="card">
      <h2>ðŸ“ˆ Ingresos</h2>
      <ul id="listaIngresos"></ul>
    </div>

    <div class="card">
      <h2>ðŸ“‰ Egresos</h2>
      <ul id="listaEgresos"></ul>
    </div>

    <!-- GrÃ¡ficos -->
    <div class="card">
      <h2>ðŸ“Š GrÃ¡ficos</h2>
      <canvas id="grafico"></canvas>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Importar el mÃ³dulo con Firebase -->
  <script type="module">
    import { agregarMovimiento, mostrarTodos, filtrar, filtrarPorFecha } from "./contabilidad.js";

    // Hacer accesibles las funciones al HTML
    window.agregarMovimiento = agregarMovimiento;
    window.mostrarTodos = mostrarTodos;
    window.filtrar = filtrar;
    window.filtrarPorFecha = filtrarPorFecha;
  </script>

  <script>
    function toggleMenu() {
      document.getElementById("sidebar").classList.toggle("open");
    }
    document.addEventListener("click", function(e) {
      const sidebar = document.getElementById("sidebar");
      const toggle = document.querySelector(".menu-toggle");
      if (!sidebar.contains(e.target) && !toggle.contains(e.target)) {
        sidebar.classList.remove("open");
      }
    });
  </script>
</body>
</html>
